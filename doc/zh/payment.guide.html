<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>payment.guide.html</title>
  <meta name="generator" content="Haroopad 0.11.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF) repeat scroll 0 0 transparent;background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:medium none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:medium none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:medium none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:none no-repeat scroll 5px -27px #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:none repeat scroll 0 0 #FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:none repeat scroll 0 0 #EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:none repeat scroll 0 0 #75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:#1A3C6C solid 1px;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-bottom-width:0;border-left-width:0;border-right-width:0;border-top-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;max-width:none;min-height:0;outline-color:#112644;outline-style:none;outline-width:0;overflow-x:visible;overflow-y:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;border:0 none;color:#ccc;height:3px;padding:0}hr.underscore{border:0 none!important;height:30px;padding:0;-webkit-margin-before:0;-webkit-margin-after:0}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:#fff url(../img/ajax.gif) no-repeat center center}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}.markdown{padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-break:break-all;word-wrap:break-word}.markdown pre{border-radius:3px;word-break:break-all;word-wrap:break-word;overflow:auto}.markdown pre code{display:block}.markdown pre>code{border:1px solid #ccc;white-space:pre;padding:.5em;margin:0}.markdown code{border-radius:3px;word-break:break-all;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown table{padding:0;border-collapse:collapse;border-spacing:0}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.markdown em.underline{font-style:normal;text-decoration:underline}.markdown strong.highlight{color:#000;padding:0 5px;background-color:#fdffb6;-webkit-box-shadow:#fdffb6 0 0 5px;-moz-box-shadow:#fdffb6 0 0 5px;box-shadow:#fdffb6 0 0 5px}@import url(http://fonts.googleapis.com/css?family=Tauri);import url(http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,400italic,700italic,400,300,700);.haroopad{padding:20px;color:#222;font-size:15px;font-family:'Roboto Condensed',Tauri,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",AppleSDGothicNeo-Medium,'Segoe UI','Malgun Gothic',Verdana,Tahoma,sans-serif;background:#fff;-webkit-font-smoothing:antialiased}.haroopad a{color:#3269a0}.haroopad a:hover{color:#4183c4}.haroopad h2{border-bottom:1px solid #e6e6e6;line-height:1.7em}.haroopad h6{color:#777}.haroopad hr{border:1px solid #e6e6e6}.haroopad blockquote>code,.haroopad h1>code,.haroopad h2>code,.haroopad h3>code,.haroopad h4>code,.haroopad h5>code,.haroopad h6>code,.haroopad li>code,.haroopad p>code,.haroopad td>code{color:#000;background-color:#feecdd;border:1px solid #efdfd0}.haroopad pre>code{font-size:1em;font-family:Consolas,Inconsolata,Courier,monospace;letter-spacing:-1px;font-weight:700}.haroopad blockquote{border-left:4px solid #e6e6e6;padding:0 15px;color:#777}.haroopad table{background-color:#fafafa}.haroopad table tr td,.haroopad table tr th{border:1px solid #e6e6e6}.haroopad table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;padding:.5em;background:#F0F0F0}.clojure .hljs-built_in,.hljs,.hljs-subst,.hljs-tag .hljs-title,.lisp .hljs-title,.nginx .hljs-title{color:#000}.apache .hljs-cbracket,.apache .hljs-tag,.asciidoc .hljs-header,.bash .hljs-variable,.coffeescript .hljs-attribute,.django .hljs-variable,.erlang_repl .hljs-function_or_atom,.haml .hljs-symbol,.hljs-addition,.hljs-aggregate,.hljs-constant,.hljs-flow,.hljs-parent,.hljs-pragma,.hljs-preprocessor,.hljs-rules .hljs-value,.hljs-stream,.hljs-string,.hljs-tag .hljs-value,.hljs-template_tag,.hljs-title,.markdown .hljs-header,.ruby .hljs-symbol,.ruby .hljs-symbol .hljs-string,.smalltalk .hljs-class,.tex .hljs-command,.tex .hljs-special{color:#800}.asciidoc .hljs-blockquote,.diff .hljs-header,.hljs-annotation,.hljs-chunk,.hljs-comment,.hljs-template_comment,.markdown .hljs-blockquote,.smartquote{color:#888}.asciidoc .hljs-bullet,.asciidoc .hljs-link_url,.go .hljs-constant,.hljs-change,.hljs-date,.hljs-hexcolor,.hljs-literal,.hljs-number,.hljs-regexp,.lasso .hljs-variable,.makefile .hljs-variable,.markdown .hljs-bullet,.markdown .hljs-link_url,.smalltalk .hljs-char,.smalltalk .hljs-symbol{color:#080}.apache .hljs-sqbracket,.asciidoc .hljs-attribute,.asciidoc .hljs-link_label,.clojure .hljs-attribute,.coffeescript .hljs-property,.erlang_repl .hljs-reserved,.haml .hljs-bullet,.hljs-array,.hljs-attr_selector,.hljs-decorator,.hljs-deletion,.hljs-doctype,.hljs-envvar,.hljs-filter .hljs-argument,.hljs-important,.hljs-javadoc,.hljs-label,.hljs-localvars,.hljs-phony,.hljs-pi,.hljs-prompt,.hljs-pseudo,.hljs-shebang,.lasso .hljs-attribute,.markdown .hljs-link_label,.nginx .hljs-built_in,.ruby .hljs-string,.tex .hljs-formula,.vhdl .hljs-attribute{color:#88F}.apache .hljs-tag,.asciidoc .hljs-strong,.bash .hljs-variable,.css .hljs-tag,.go .hljs-typename,.hljs-aggregate,.hljs-built_in,.hljs-id,.hljs-javadoctag,.hljs-keyword,.hljs-phpdoc,.hljs-request,.hljs-status,.hljs-title,.hljs-winutils,.hljs-yardoctag,.markdown .hljs-strong,.smalltalk .hljs-class,.tex .hljs-command{font-weight:700}.asciidoc .hljs-emphasis,.markdown .hljs-emphasis{font-style:italic}.nginx .hljs-built_in{font-weight:400}.coffeescript .javascript,.javascript .xml,.lasso .markup,.tex .hljs-formula,.xml .css,.xml .hljs-cdata,.xml .javascript,.xml .vbscript{opacity:.5}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown haroopad">

  <h1 id="支付开发指南"><a name="支付开发指南" href="#支付开发指南"></a>支付开发指南</h1><p class="toc" style="undefined"></p><ul>
<li><ul>
<li><span class="title">
<a href="#开发者账户" title="开发者账户">开发者账户</a>
</span>
<!--span class="number">
0
</span-->
</li>
<li><span class="title">
<a href="#如何运行demo" title="如何运行DEMO">如何运行DEMO</a>
</span>
<!--span class="number">
1
</span-->
</li>
<li><span class="title">
<a href="#可用的支付方式" title="可用的支付方式">可用的支付方式</a>
</span>
<!--span class="number">
2
</span-->
<ul>
<li><span class="title">
<a href="#小葱币" title="小葱币">小葱币</a>
</span>
<!--span class="number">
3
</span-->
</li>
<li><span class="title">
<a href="#yeepay" title="Yeepay">Yeepay</a>
</span>
<!--span class="number">
4
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#使用sdk" title="使用SDK">使用SDK</a>
</span>
<!--span class="number">
5
</span-->
</li>
<li><span class="title">
<a href="#服务器回调" title="服务器回调">服务器回调</a>
</span>
<!--span class="number">
6
</span-->
</li>
<li><span class="title">
<a href="#查询订单" title="查询订单">查询订单</a>
</span>
<!--span class="number">
7
</span-->
</li>
</ul>
</li>

</ul>
<p></p><p><a name="appply_for_account"></a></p><h2 id="开发者账户"><a name="开发者账户" href="#开发者账户"></a>开发者账户</h2><p>与小葱支付服务器交互，需要使用MD5或RSA加密数据。为此，需要申请开发者标识（<code>partnerId</code>）和MD5、RSA密钥。</p><p>当使用小葱币支付时，需要用户使用小葱 <em>OAuth 2</em> 登录。使用OAuth2需要申请<code>client_id</code>/<code>client_secret</code>。</p><h2 id="如何运行demo"><a name="如何运行demo" href="#如何运行demo"></a>如何运行DEMO</h2><p>SDK 以 Android Library 工程的形式提供。下载地址：<a href="https://github.com/XiaoCongGame/sdk-smart-lib">https://github.com/XiaoCongGame/sdk-smart-lib</a></p><p>Demo工程下载：<a href="https://github.com/XiaoCongGame/sdk-smart-demo">https://github.com/XiaoCongGame/sdk-smart-demo</a></p><p>将两个工程下载后，导入Eclipse。配置Demo工程依赖SDK工程。运行Demo工程即可。</p><h2 id="可用的支付方式"><a name="可用的支付方式" href="#可用的支付方式"></a>可用的支付方式</h2><p>目前我们支持以下支付方式：</p><ul>
<li>小葱币</li>
<li>支付宝</li>
<li>易宝</li>
<li>PP（信用）支付</li>
<li>360币</li>
</ul><p><img src="img/payways.png" alt=""></p><h3 id="小葱币"><a name="小葱币" href="#小葱币"></a>小葱币</h3><p>下面是小葱币的支付界面。界面将显示本次需要支付的小葱币数量，当前账户余额与账户ID。用户可以选择更换支付账户——如果——例如，当前账户余额不足。<br><img src="img/xc_xiaocong_coins.png" alt=""></p><p>如果检测到用户已登录，且登录未过期，则将直接使用存在的账户。否则，在此界面可能弹出登录对话框：</p><ul>
<li>如果用户选择更换账户</li>
<li>如果之前登录的账户过期。</li>
</ul><p><img src="img/xiaocong-coins-change-account.png" alt=""></p><p>如果你不想让用户切换账户，例如，你向让用户用已登录过的小葱账户支付，则你需要传给我们之前登录时获得的accessToken。</p><h3 id="yeepay"><a name="yeepay" href="#yeepay"></a>Yeepay</h3><p>If the user use this provider first time, a screen that collects all information for payment will show up as following:</p><p><img src="img/yeepay_input_cards.png" alt=""></p><p>The card information will be persistent. So next time you use this provider, there’re be a list of cards from which you could select one, instead of typing again.</p><p><img src="img/yeepay_list.png" alt=""></p><h2 id="使用sdk"><a name="使用sdk" href="#使用sdk"></a>使用SDK</h2><p>请参见Demo工程的代码。</p><p>开发者ID、密钥统一放在<code>tv.xiaocong.sdk.demo.Keys</code>。可以替换为您的正式账户和密钥。</p><blockquote>
<p>风险警示：实际项目中，密钥不建议以明文形式放在Java源代码或配置文件中。建议放在服务器上，并通过加密通信获取。至少，应该编译到so库中，增加破解难度。</p>
</blockquote><p>支付的进入点是<code>PaymentHelper.startMe</code>：</p><pre><code class="java hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    /**
     * Execute payment.
     * 
     * @param caller
     *            (Required) the activity that starts {@link PaymentStartActivity}.
     * @param partnerId
     *            (Required)
     * @param amount
     *            (Required) the money to pay. The unit is RMB cent. (1 Xiaocong coin == 1 RMB
     *            cent.)
     * @param signType
     *            (Required) md5 or RSA
     * @param orderNo
     *            (Required) the order number in your system. Should be unique for all your request.
     *            Prefixed by your partnerId. Format: ^{12,30}$.
     * @param pkgname
     *            (Required) the package name of you application
     * @param goodsDes
     *            (Required) some descriptions about your goods
     * @param signature
     *            (Required) the request signature. For the format of the signature, refer to
     *            {@link MainActivity#getSign(int, int, String, String, String)}.
     * @param notifyUrl
     *            (Required) the callback URL in your server.
     * @param remark
     *            (Optional) some remark for this order
     * @param accessToken
     *            (Optional) If you don't want users to change their account, provide a accessToken
     *            yourself; If you pass null, then we'll pop up login dialog to get the accessToken
     *            if necessary.
     */
    public static void pay(Activity caller, int partnerId, int amount, String signType,
            String orderNo, String pkgname, String goodsDes, String signature, String notifyUrl,
            String remark, String accessToken) {
        PaymentHelper.startMe(caller, partnerId, amount, signType, orderNo, pkgname, goodsDes,
                signature, notifyUrl, remark, Keys.CLIENT_ID, Keys.CLIENT_SECRET, accessToken);
    }
&lt;/code&gt;&lt;/pre&gt;">    <span class="hljs-javadoc">/**
     * Execute payment.
     * 
     *<span class="hljs-javadoctag"> @param</span> caller
     *            (Required) the activity that starts {@link PaymentStartActivity}.
     *<span class="hljs-javadoctag"> @param</span> partnerId
     *            (Required)
     *<span class="hljs-javadoctag"> @param</span> amount
     *            (Required) the money to pay. The unit is RMB cent. (1 Xiaocong coin == 1 RMB
     *            cent.)
     *<span class="hljs-javadoctag"> @param</span> signType
     *            (Required) md5 or RSA
     *<span class="hljs-javadoctag"> @param</span> orderNo
     *            (Required) the order number in your system. Should be unique for all your request.
     *            Prefixed by your partnerId. Format: ^{12,30}$.
     *<span class="hljs-javadoctag"> @param</span> pkgname
     *            (Required) the package name of you application
     *<span class="hljs-javadoctag"> @param</span> goodsDes
     *            (Required) some descriptions about your goods
     *<span class="hljs-javadoctag"> @param</span> signature
     *            (Required) the request signature. For the format of the signature, refer to
     *            {@link MainActivity#getSign(int, int, String, String, String)}.
     *<span class="hljs-javadoctag"> @param</span> notifyUrl
     *            (Required) the callback URL in your server.
     *<span class="hljs-javadoctag"> @param</span> remark
     *            (Optional) some remark for this order
     *<span class="hljs-javadoctag"> @param</span> accessToken
     *            (Optional) If you don't want users to change their account, provide a accessToken
     *            yourself; If you pass null, then we'll pop up login dialog to get the accessToken
     *            if necessary.
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pay</span>(Activity caller, <span class="hljs-keyword">int</span> partnerId, <span class="hljs-keyword">int</span> amount, String signType,
            String orderNo, String pkgname, String goodsDes, String signature, String notifyUrl,
            String remark, String accessToken) {
        PaymentHelper.startMe(caller, partnerId, amount, signType, orderNo, pkgname, goodsDes,
                signature, notifyUrl, remark, Keys.CLIENT_ID, Keys.CLIENT_SECRET, accessToken);
    }
</code></pre><p>所有可能的支付结果列在<code>com.xiaocong.sdk.PaymentResults</code>。</p><ul>
<li><code>ILLEGAL_PARAMETER</code>: Your request(ie. calling <code>pay</code>) is invalid.</li>
<li><code>NO_PAY_WAY</code>: 没有可用的支付方式。请联系商务人员检查签约时约定的支付方式。</li>
<li><code>PAYRESULT_OK</code>: 支付成功。</li>
<li><code>PAYRESULT_FAIL</code>: 支付失败。</li>
<li><code>CANCEL_BUY</code>: 用户取消支付。</li>
<li><code>CREATE_ORDER_FAIL</code>: 不能在小葱支付系统内创建定单。</li>
<li><code>DUPLICATE_ORDER_NO</code>：订单号重复。如果遇到这个错误，请检查你的订单号生成逻辑，可能有BUG。</li>
<li><code>PAYRESULT_PENDING</code>: 支付结果不确定。请等待服务器回调。</li>
<li><code>PAYRESULT_FAIL_NET</code>：网络错误，网络未连接或中断</li>
</ul><h2 id="服务器回调"><a name="服务器回调" href="#服务器回调"></a>服务器回调</h2><p>最终您的游戏服务器会收到我们的回调。回调以POST发出。参数在HTTP Body中。格式编码为<code>x-www-form-urlencoded</code>。携带以下参数：</p><pre><code data-origin="&lt;pre&gt;&lt;code&gt;orderNo=2013041510251288&amp;amp;amount=10&amp;amp;account=13218181&amp;amp;notifyTime=12365212352&amp;amp;goodsDes=sword&amp;amp;status=1&amp;amp;sign=ZPZULntRpJwFmGNIVKwjLEF2Tze7bqs60rxQ22CqT5J1UlvGo575QK9z/+p+7E9cOoRoWzqR6xHZ6WVv3dloyGKDR0btvrdq PgUAoeaX/YOWzTh00vwcQ+HBtXE+vPTfAqjCTxiiSJEOY7ATCF1q7iP3sfQxhS0nDUug1LP3OLk&amp;amp;mark=testcontent
&lt;/code&gt;&lt;/pre&gt;">orderNo=2013041510251288&amp;amount=10&amp;account=13218181&amp;notifyTime=12365212352&amp;goodsDes=sword&amp;status=1&amp;sign=ZPZULntRpJwFmGNIVKwjLEF2Tze7bqs60rxQ22CqT5J1UlvGo575QK9z/+p+7E9cOoRoWzqR6xHZ6WVv3dloyGKDR0btvrdq PgUAoeaX/YOWzTh00vwcQ+HBtXE+vPTfAqjCTxiiSJEOY7ATCF1q7iP3sfQxhS0nDUug1LP3OLk&amp;mark=testcontent
</code></pre><p>参数解释：</p><ul>
<li><code>orderNo</code>: 您给我们的订单号</li>
<li><code>amount</code>: 单位为分</li>
<li><code>account</code>: 用户小葱号</li>
<li><code>sign</code>: 请求签名。签名格式参见<a href="https://github.com/XiaoCongGame/xcPay_notify_demo/blob/master/src/main/webapp/notify.jsp">notify.jsp</a>。</li>
<li><code>notifyTime</code>：回调时间，一个长整数。</li>
<li><code>goodsDes</code>：您在支付时传来的商品描述。</li>
<li><code>status</code>: <code>1</code>表示成功；<code>2</code>表示失败。</li>
<li><code>mark</code>: 您在支付时传来的备注。</li>
</ul><p>当收到我们的回调后，您可以给出以下响应，在HTTP响应Body中显示以下几个简单的字符：</p><ul>
<li><code>success</code>: you got the result</li>
<li><code>fail</code>: any exceptions</li>
<li><code>sign_fail</code>: for invalid signature</li>
</ul><p>在收到订单并处理完后，服务器会立即回调。如果回调失败（如你们的服务器没开），会隔3分钟左右再次回调。若24小时内都不能回调成功，将不再回调。</p><blockquote>
<p>多数情况下，不需要依赖回调。如果客户端显式返回成功，则订单最终一定会成功。只有客户端返回状态未决时（<code>PAYRESULT_PENDING</code>），才需要根据回调确定结果。</p>
</blockquote><h2 id="查询订单"><a name="查询订单" href="#查询订单"></a>查询订单</h2><p>可以通过以下URL查询订单：</p><pre><code data-origin="&lt;pre&gt;&lt;code&gt;http://data.xiaocong.tv/queryOrderInfo.action?orderNo=2013041510251288&amp;amp;version=2&amp;amp;sign=b4600ae75b27f5fe1fb213f6e6d9620a
&lt;/code&gt;&lt;/pre&gt;">http://data.xiaocong.tv/queryOrderInfo.action?orderNo=2013041510251288&amp;version=2&amp;sign=b4600ae75b27f5fe1fb213f6e6d9620a
</code></pre><p>Http请求参数：</p><ul>
<li><code>orderNo</code> [String]：The order number in your system, which is identical with the parameter <code>orderNo</code> of <code>XcPayUtils.pay</code>.</li>
<li><code>version</code> [int]：Always be <code>2</code>。</li>
<li><code>sign</code> [String]：The signature, which is identical with the parameter <code>signature</code> of <code>XcPayUtils.pay</code>.</li>
</ul><p>The reponse is plain text, like <code>Code~Message</code>. For example, for successful payment, the response is <code>200~Success</code>.</p><p>The full list of response text:</p><ul>
<li><code>200~Success</code>: success</li>
<li><code>512~Order payment failure</code>: payment failure</li>
<li><code>210~Order processing</code>: processing</li>
<li><code>509~Order not exists</code>: the order isn’t existed</li>
<li><code>400~Version number error</code>: invalid <code>version</code></li>
<li><code>400~Order number is request</code>: <code>orderNo</code> is missing</li>
<li><code>400~Sign is request</code>: <code>sign</code> is missing</li>
<li><code>401~Sign verification failed</code>: invalid <code>sign</code></li>
</ul>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
